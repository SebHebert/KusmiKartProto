<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uranie - Accueil</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="../assets/css/style-global.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Metamorphous&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
        }
        
        .mockery-font {
            font-family: 'Metamorphous', 'Georgia', serif;
        }
        
        /* Sidebar */
        .sidebar {
            transition: transform 0.3s ease;
        }
        
        .sidebar.collapsed {
            transform: translateX(-100%);
        }
        
        /* Submenu */
        .submenu {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .submenu.open {
            max-height: 500px;
        }
        
        /* Rectangle cards */
        .card-rectangle {
            transition: all 0.3s ease;
        }
        
        .card-rectangle:not(.central):hover {
            transform: scale(1.08);
        }
        
        .card-rectangle.selected {
            opacity: 0.5 !important;
            position: relative;
        }

        .card-rectangle.selected::before {
            content: '';
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.3);
            border-radius: inherit;
            pointer-events: none;
            z-index: 1;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen overflow-x-hidden">
    <div id="app">
        <!-- Sidebar Navigation -->
        <div 
            :class="['sidebar fixed left-0 top-0 h-full bg-gradient-to-b from-indigo-900 to-purple-900 shadow-2xl z-50', sidebarCollapsed ? 'collapsed' : '']"
            style="width: 250px;">
            <div class="flex flex-col h-full">
                <!-- Logo -->
                <div class="p-4 border-b border-white/20">
                    <img src="../assets/images/logo-luna.png" alt="Luna Logo" class="h-12 w-auto">
                </div>
                
                <!-- Menu Items -->
                <nav class="flex-1 p-4 overflow-y-auto">
                    <a href="uranie-accueil-vue.html" 
                       class="flex items-center gap-3 px-3 py-2 mb-2 text-white bg-white/10 rounded-lg hover:bg-white/20 transition-all">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                        </svg>
                        <span class="font-semibold text-sm">Accueil</span>
                    </a>
                    
                    <a href="uranie-recherche-vue.html" 
                       class="flex items-center gap-3 px-3 py-2 mb-2 text-white hover:bg-white/10 rounded-lg transition-all">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <circle cx="11" cy="11" r="8" stroke-width="2"/>
                            <path d="m21 21-4.35-4.35" stroke-width="2"/>
                        </svg>
                        <span class="font-semibold text-sm">Recherche</span>
                    </a>
                    
                    <!-- Menu Admin avec sous-menus -->
                    <div class="mb-2">
                        <button 
                            @click="adminMenuOpen = !adminMenuOpen"
                            class="flex items-center justify-between w-full px-3 py-2 text-white hover:bg-white/10 rounded-lg transition-all">
                            <div class="flex items-center gap-3">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                                    <path stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                                </svg>
                                <span class="font-semibold text-sm">Admin</span>
                            </div>
                            <svg 
                                class="w-4 h-4 transition-transform"
                                :class="{ 'rotate-180': adminMenuOpen }"
                                fill="none" 
                                stroke="currentColor" 
                                viewBox="0 0 24 24">
                                <path stroke-width="2" d="M19 9l-7 7-7-7"/>
                            </svg>
                        </button>
                        
                        <!-- Sous-menus Admin -->
                        <div 
                            :class="['submenu', { 'open': adminMenuOpen }]"
                            class="ml-4 mt-1">
                            <a href="#" 
                               @click.prevent="alert('Gestion des utilisateurs')"
                               class="flex items-center gap-3 px-3 py-2 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all text-sm">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/>
                                </svg>
                                <span>Utilisateurs</span>
                            </a>
                            
                            <a href="#" 
                               @click.prevent="alert('Gestion des processus')"
                               class="flex items-center gap-3 px-3 py-2 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all text-sm">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                                </svg>
                                <span>Processus</span>
                            </a>
                            
                            <a href="#" 
                               @click.prevent="alert('Gestion des cartographies')"
                               class="flex items-center gap-3 px-3 py-2 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all text-sm">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"/>
                                </svg>
                                <span>Cartographies</span>
                            </a>
                            
                            <a href="#" 
                               @click.prevent="alert('Paramètres système')"
                               class="flex items-center gap-3 px-3 py-2 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all text-sm">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"/>
                                </svg>
                                <span>Paramètres</span>
                            </a>
                            
                            <a href="#" 
                               @click.prevent="alert('Logs système')"
                               class="flex items-center gap-3 px-3 py-2 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all text-sm">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                </svg>
                                <span>Logs</span>
                            </a>
                        </div>
                    </div>
                </nav>
            </div>
        </div>
        
        <!-- Toggle Sidebar Button -->
        <button 
            @click="sidebarCollapsed = !sidebarCollapsed"
            class="fixed left-0 top-1/2 -translate-y-1/2 bg-indigo-900 text-white p-2 rounded-r-lg shadow-lg z-40 transition-all hover:bg-indigo-800"
            :style="{ left: sidebarCollapsed ? '0' : '250px' }">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-width="2" :d="sidebarCollapsed ? 'M9 5l7 7-7 7' : 'M15 19l-7-7 7-7'"/>
            </svg>
        </button>
        
        <!-- Toggle Dev Mode Button -->
        <button 
            @click="devMode = !devMode"
            class="fixed right-4 top-4 bg-purple-600 text-white px-4 py-2 rounded-lg shadow-lg z-40 transition-all hover:bg-purple-700"
            :class="{ 'bg-green-600 hover:bg-green-700': devMode }">
            <span class="text-sm font-bold">{{ devMode ? '✅ Mode Dev ON' : '🛠️ Mode Dev' }}</span>
        </button>

        <!-- Main Content -->
        <div 
            class="transition-all duration-300"
            :style="{ marginLeft: sidebarCollapsed ? '0' : '250px' }">
            
            <!-- Grid Layout -->
            <div class="min-h-screen flex items-center justify-center p-4">
                <div class="relative" style="width: 900px; height: 750px;">
                    
                    <!-- Centre - Kousmichoff (non cliquable, plus grand, contient la recherche) -->
                    <div class="absolute" style="top: 50%; left: 50%; transform: translate(-50%, -50%);">
                        <card-rectangle
                            title="Kusmi Tea"
                            russian="Kousmichoff"
                            color="#d97706"
                            image=""
                            :is-central="true"
                            :selected="false"
                            :search-term="searchTerm"
                            @search="handleSearch"
                            @update-search="searchTerm = $event">
                        </card-rectangle>
                    </div>
                    
                    <!-- Haut-Gauche (Tsarevna - Bleu foncé) -->
                    <div class="absolute" :style="{ top: positions.hautGauche.top + 'px', left: positions.hautGauche.left + 'px' }">
                        <card-rectangle
                            title="Carto"
                            russian="Tsarevna"
                            color="#1e3a8a"
                            image="../assets/images/tsarevna.jpg"
                            :is-central="false"
                            :selected="selectedCards.includes('carto')"
                            @click="toggleCard('carto')">
                        </card-rectangle>
                        <div v-if="devMode" class="absolute -top-8 left-0 bg-black/80 text-white text-xs px-2 py-1 rounded">
                            Top: {{positions.hautGauche.top}} / Left: {{positions.hautGauche.left}}
                        </div>
                    </div>
                    
                    <!-- Haut-Droite (Anastasia - Vert) -->
                    <div class="absolute" :style="{ top: positions.hautDroite.top + 'px', left: positions.hautDroite.left + 'px' }">
                        <card-rectangle
                            title="Process"
                            russian="Anastasia"
                            color="#059669"
                            image=""
                            :is-central="false"
                            :selected="selectedCards.includes('process')"
                            @click="toggleCard('process')">
                        </card-rectangle>
                        <div v-if="devMode" class="absolute -top-8 left-0 bg-black/80 text-white text-xs px-2 py-1 rounded">
                            Top: {{positions.hautDroite.top}} / Left: {{positions.hautDroite.left}}
                        </div>
                    </div>
                    
                    <!-- Bas-Gauche (Prince Vladimir - Cyan) -->
                    <div class="absolute" :style="{ top: positions.basGauche.top + 'px', left: positions.basGauche.left + 'px' }">
                        <card-rectangle
                            title="Flow"
                            russian="Prince Vladimir"
                            color="#0891b2"
                            image=""
                            :is-central="false"
                            :selected="selectedCards.includes('flow')"
                            @click="toggleCard('flow')">
                        </card-rectangle>
                        <div v-if="devMode" class="absolute -top-8 left-0 bg-black/80 text-white text-xs px-2 py-1 rounded">
                            Top: {{positions.basGauche.top}} / Left: {{positions.basGauche.left}}
                        </div>
                    </div>
                    
                    <!-- Bas-Droite (St-Pétersbourg - Teal) -->
                    <div class="absolute" :style="{ top: positions.basDroite.top + 'px', left: positions.basDroite.left + 'px' }">
                        <card-rectangle
                            title="Hardware"
                            russian="St-Pétersbourg"
                            color="#14b8a6"
                            image=""
                            :is-central="false"
                            :selected="selectedCards.includes('hardware')"
                            @click="toggleCard('hardware')">
                        </card-rectangle>
                        <div v-if="devMode" class="absolute -top-8 left-0 bg-black/80 text-white text-xs px-2 py-1 rounded">
                            Top: {{positions.basDroite.top}} / Left: {{positions.basDroite.left}}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Vue.js -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <script>
        const { createApp } = Vue;

        // Composant rectangle
        const CardRectangle = {
            emits: ['click', 'search', 'update-search'],
            template: `
                <div 
                    class="card-rectangle relative overflow-hidden rounded-2xl cursor-pointer"
                    :class="{ 
                        'central': isCentral,
                        'selected': selected && !isCentral
                    }"
                    :style="combinedStyle"
                    @click="handleClick">
                    
                    <!-- Image de fond -->
                    <div v-if="image" 
                         class="absolute inset-0 bg-cover bg-center"
                         :style="{ backgroundImage: 'url(' + image + ')' }">
                    </div>
                    
                    <!-- Overlay gradient -->
                    <div class="absolute inset-0"
                         :style="{ 
                             background: 'linear-gradient(135deg, ' + color + 'CC 0%, ' + color + 'EE 100%)'
                         }">
                    </div>
                    
                    <!-- Contenu -->
                    <div class="relative h-full flex flex-col justify-center items-center text-center px-4">
                        <!-- Titre principal -->
                        <h2 class="mockery-font font-bold text-white leading-tight"
                            :class="isCentral ? 'text-4xl mb-2' : 'text-3xl mb-1'"
                            style="text-shadow: 2px 2px 8px rgba(0,0,0,0.5)">
                            {{ russian }}
                        </h2>
                        
                        <!-- Sous-titre -->
                        <p class="text-white/90 font-semibold"
                           :class="isCentral ? 'text-lg mb-4' : 'text-lg'"
                           style="text-shadow: 1px 1px 4px rgba(0,0,0,0.5)">
                            {{ title }}
                        </p>
                        
                        <!-- Champ de recherche (uniquement pour central) -->
                        <div v-if="isCentral" class="w-full px-6 mt-2">
                            <div class="relative">
                                <input 
                                    type="text" 
                                    :value="searchTerm"
                                    @input="$emit('update-search', $event.target.value)"
                                    @keyup.enter="$emit('search')"
                                    @click.stop
                                    placeholder="Rechercher..."
                                    class="w-full px-4 py-2 pr-10 rounded-full border-2 border-amber-600 focus:border-amber-700 focus:outline-none text-sm bg-white text-gray-800 shadow-lg">
                                <button 
                                    @click.stop="$emit('search')"
                                    class="absolute right-1 top-1/2 -translate-y-1/2 p-1.5 bg-amber-600 hover:bg-amber-700 rounded-full transition-colors">
                                    <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <circle cx="11" cy="11" r="8" stroke-width="2"/>
                                        <path d="m21 21-4.35-4.35" stroke-width="2"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Border -->
                    <div class="absolute inset-0 rounded-2xl border-4 pointer-events-none"
                         :style="{ borderColor: color }">
                    </div>
                </div>
            `,
            props: {
                title: String,
                russian: String,
                color: String,
                image: String,
                selected: Boolean,
                isCentral: Boolean,
                searchTerm: String
            },
            computed: {
                combinedStyle() {
                    const baseStyle = {
                        boxShadow: `0 10px 30px ${this.color}40`
                    };
                    
                    if (this.isCentral) {
                        return {
                            ...baseStyle,
                            width: '300px',
                            height: '220px'
                        };
                    } else {
                        return {
                            ...baseStyle,
                            width: '240px',
                            height: '150px'
                        };
                    }
                }
            },
            methods: {
                handleClick() {
                    if (!this.isCentral) {
                        console.log('🎯 Composant cliqué, émission événement click');
                        console.log('🔍 État selected:', this.selected);
                        this.$emit('click');
                    } else {
                        console.log('⚠️ Rectangle central cliqué - pas d\'action');
                    }
                }
            },
            watch: {
                selected(newVal) {
                    console.log(`👁️ Prop selected changée pour ${this.title}:`, newVal);
                }
            }
        };

        // Application principale
        createApp({
            components: {
                CardRectangle
            },
            data() {
                return {
                    sidebarCollapsed: false,
                    adminMenuOpen: false,
                    searchTerm: '',
                    selectedCards: [],
                    devMode: false,
                    positions: {
                        hautGauche: { top: 102, left: 132 },
                        hautDroite: { top: 102, left: 528 },
                        basGauche: { top: 498, left: 132 },
                        basDroite: { top: 498, left: 528 }
                    }
                }
            },
            methods: {
                alert(message) {
                    window.alert(message);
                },
                handleSearch() {
                    // Redirection vers la recherche des couleurs
                    const params = new URLSearchParams();
                    params.set('q', 'Couleur B2B');
                    params.set('category', 'process');
                    window.location.href = 'uranie-recherche-vue.html?' + params.toString();
                },
                toggleCard(cardId) {
                    console.log('🔔 Clic sur rectangle:', cardId);
                    console.log('📋 Sélection actuelle AVANT:', [...this.selectedCards]);
                    
                    const index = this.selectedCards.indexOf(cardId);
                    if (index > -1) {
                        // Déjà sélectionné, on le désélectionne (réactive)
                        this.selectedCards.splice(index, 1);
                        console.log('✅ Désélectionné:', cardId);
                    } else {
                        // Pas sélectionné, on le sélectionne (assombrit)
                        this.selectedCards.push(cardId);
                        console.log('🔒 Sélectionné (grisé):', cardId);
                    }
                    
                    console.log('📋 Sélection actuelle APRÈS:', [...this.selectedCards]);
                    console.log('---');
                },
                exportCode() {
                    const code = `
<!-- Haut-Gauche (Tsarevna) -->
<div class="absolute" style="top: ${this.positions.hautGauche.top}px; left: ${this.positions.hautGauche.left}px;">

<!-- Haut-Droite (Anastasia) -->
<div class="absolute" style="top: ${this.positions.hautDroite.top}px; left: ${this.positions.hautDroite.left}px;">

<!-- Bas-Gauche (Prince Vladimir) -->
<div class="absolute" style="top: ${this.positions.basGauche.top}px; left: ${this.positions.basGauche.left}px;">

<!-- Bas-Droite (St-Pétersbourg) -->
<div class="absolute" style="top: ${this.positions.basDroite.top}px; left: ${this.positions.basDroite.left}px;">
                    `.trim();
                    
                    navigator.clipboard.writeText(code).then(() => {
                        alert('✅ Code copié dans le presse-papier !\n\nVous pouvez maintenant le coller dans votre code.');
                    }).catch(() => {
                        // Fallback si clipboard API ne fonctionne pas
                        prompt('📋 Copiez ce code:', code);
                    });
                }
            },
            mounted() {
                console.log('✨ Application Uranie démarrée');
                console.log('💡 Cliquez sur les rectangles pour les griser/activer');
                console.log('📊 État initial selectedCards:', this.selectedCards);
            }
        }).mount('#app');
    </script>
</body>
</html>
