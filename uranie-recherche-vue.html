<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uranie - Recherche</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        .star {
            animation: pulse 2s ease-in-out infinite;
        }
        
        /* Sidebar */
        .sidebar {
            transition: transform 0.3s ease;
        }
        
        .sidebar.collapsed {
            transform: translateX(-100%);
        }
        
        /* Submenu */
        .submenu {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .submenu.open {
            max-height: 500px;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-800 min-h-screen overflow-hidden">
    <div id="app">
        <!-- Sidebar Navigation -->
        <div 
            :class="['sidebar fixed left-0 top-0 h-full bg-gradient-to-b from-indigo-900 to-purple-900 shadow-2xl z-50', sidebarCollapsed ? 'collapsed' : '']"
            style="width: 250px;">
            <div class="flex flex-col h-full">
                <!-- Logo -->
                <div class="p-4 border-b border-white/20">
                    <img src="logo-luna.png" alt="Luna Logo" class="h-12 w-auto">
                </div>
                
                <!-- Menu Items -->
                <nav class="flex-1 p-4 overflow-y-auto">
                    <a href="uranie-accueil-vue.html" 
                       class="flex items-center gap-3 px-3 py-2 mb-2 text-white hover:bg-white/10 rounded-lg transition-all">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                        </svg>
                        <span class="font-semibold text-sm">Accueil</span>
                    </a>
                    
                    <a href="uranie-recherche-vue.html" 
                       class="flex items-center gap-3 px-3 py-2 mb-2 text-white bg-white/10 rounded-lg hover:bg-white/20 transition-all">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <circle cx="11" cy="11" r="8" stroke-width="2"/>
                            <path d="m21 21-4.35-4.35" stroke-width="2"/>
                        </svg>
                        <span class="font-semibold text-sm">Recherche</span>
                    </a>
                    
                    <!-- Menu Admin avec sous-menus -->
                    <div class="mb-2">
                        <button 
                            @click="adminMenuOpen = !adminMenuOpen"
                            class="flex items-center justify-between w-full px-3 py-2 text-white hover:bg-white/10 rounded-lg transition-all">
                            <div class="flex items-center gap-3">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                                    <path stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                                </svg>
                                <span class="font-semibold text-sm">Admin</span>
                            </div>
                            <svg 
                                class="w-4 h-4 transition-transform"
                                :class="{ 'rotate-180': adminMenuOpen }"
                                fill="none" 
                                stroke="currentColor" 
                                viewBox="0 0 24 24">
                                <path stroke-width="2" d="M19 9l-7 7-7-7"/>
                            </svg>
                        </button>
                        
                        <!-- Sous-menus Admin -->
                        <div 
                            :class="['submenu', { 'open': adminMenuOpen }]"
                            class="ml-4 mt-1">
                            <a href="#" 
                               @click.prevent="alert('Gestion des utilisateurs')"
                               class="flex items-center gap-3 px-3 py-2 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all text-sm">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/>
                                </svg>
                                <span>Utilisateurs</span>
                            </a>
                            
                            <a href="#" 
                               @click.prevent="alert('Gestion des processus')"
                               class="flex items-center gap-3 px-3 py-2 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all text-sm">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                                </svg>
                                <span>Processus</span>
                            </a>
                            
                            <a href="#" 
                               @click.prevent="alert('Gestion des cartographies')"
                               class="flex items-center gap-3 px-3 py-2 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all text-sm">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"/>
                                </svg>
                                <span>Cartographies</span>
                            </a>
                            
                            <a href="#" 
                               @click.prevent="alert('Paramètres système')"
                               class="flex items-center gap-3 px-3 py-2 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all text-sm">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"/>
                                </svg>
                                <span>Paramètres</span>
                            </a>
                            
                            <a href="#" 
                               @click.prevent="alert('Logs système')"
                               class="flex items-center gap-3 px-3 py-2 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all text-sm">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                </svg>
                                <span>Logs</span>
                            </a>
                        </div>
                    </div>
                </nav>
            </div>
        </div>
        
        <!-- Toggle Sidebar Button -->
        <button 
            @click="sidebarCollapsed = !sidebarCollapsed"
            class="fixed left-0 top-1/2 -translate-y-1/2 bg-indigo-900 text-white p-2 rounded-r-lg shadow-lg z-40 transition-all hover:bg-indigo-800"
            :style="{ left: sidebarCollapsed ? '0' : '250px' }">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-width="2" :d="sidebarCollapsed ? 'M9 5l7 7-7 7' : 'M15 19l-7-7 7-7'"/>
            </svg>
        </button>

        <!-- Étoiles de fond -->
        <div v-for="star in stars" :key="star.id" 
             class="star absolute rounded-full bg-white opacity-50"
             :class="star.size"
             :style="{ left: star.left, top: star.top, animationDelay: star.delay }">
        </div>

        <!-- Main Content -->
        <div 
            class="transition-all duration-300"
            :style="{ marginLeft: sidebarCollapsed ? '0' : '250px' }">
            
            <div class="container mx-auto px-4 py-12 relative z-10">
                <!-- Header -->
                <header class="text-center mb-12 fade-in">
                    <h1 class="text-5xl font-bold text-white mb-3" 
                        style="font-family: Georgia, serif; text-shadow: 4px 4px 8px rgba(0,0,0,0.5)">
                        Recherche Uranie
                    </h1>
                    <p class="text-purple-200 italic text-lg">Explorez l'univers de vos processus et ressources</p>
                </header>

                <!-- Carte principale de recherche -->
                <div class="max-w-3xl mx-auto">
                    <div class="bg-white/10 backdrop-blur-lg rounded-3xl shadow-2xl p-8 border border-white/20 fade-in"
                         style="animation-delay: 0.2s">
                        
                        <form @submit.prevent="handleSearch">
                            <!-- Champ de recherche principal -->
                            <div class="mb-8">
                                <label class="block text-white text-sm font-semibold mb-3" 
                                       style="font-family: Georgia, serif;">
                                    Que recherchez-vous ?
                                </label>
                                <div class="relative">
                                    <input
                                        type="text"
                                        v-model="searchTerm"
                                        placeholder="Entrez votre recherche..."
                                        class="w-full px-6 py-4 pr-14 rounded-2xl border-2 border-purple-300/50 focus:border-purple-400 focus:outline-none text-lg bg-white/95 shadow-lg transition-all text-gray-800"
                                        style="font-family: Georgia, serif">
                                    <div class="absolute right-3 top-1/2 -translate-y-1/2 w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center shadow-lg">
                                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <circle cx="11" cy="11" r="8" stroke-width="2"/>
                                            <path d="m21 21-4.35-4.35" stroke-width="2"/>
                                        </svg>
                                    </div>
                                </div>
                            </div>

                            <!-- Filtres -->
                            <div class="mb-8">
                                <label class="block text-white text-sm font-semibold mb-4" 
                                       style="font-family: Georgia, serif;">
                                    Filtrer par catégorie
                                </label>
                                
                                <div class="grid grid-cols-2 md:grid-cols-5 gap-4">
                                    <div v-for="(filter, index) in filters" 
                                         :key="filter.id"
                                         class="fade-in"
                                         :style="{ animationDelay: `${0.3 + index * 0.1}s` }">
                                        <input
                                            type="checkbox"
                                            :id="filter.id"
                                            v-model="filter.checked"
                                            class="hidden">
                                        <label
                                            :for="filter.id"
                                            class="block cursor-pointer p-4 rounded-xl border-2 transition-all duration-300 text-center"
                                            :class="filter.checked 
                                                ? 'scale-105' 
                                                : 'hover:bg-white/10'"
                                            :style="getLabelStyle(filter)">
                                            <div class="text-3xl mb-2">{{ filter.icon }}</div>
                                            <div class="text-white font-semibold text-sm">{{ filter.label }}</div>
                                            <svg v-if="filter.checked" 
                                                 class="w-4 h-4 text-white mx-auto mt-2" 
                                                 fill="none" 
                                                 stroke="currentColor" 
                                                 viewBox="0 0 24 24">
                                                <polyline points="20 6 9 17 4 12" stroke-width="3"/>
                                            </svg>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- Bouton de validation -->
                            <button
                                type="submit"
                                class="w-full py-4 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold text-lg rounded-2xl shadow-xl transition-all duration-300 transform hover:scale-105 hover:shadow-2xl"
                                style="font-family: Georgia, serif;">
                                <div class="flex items-center justify-center gap-3">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <circle cx="11" cy="11" r="8" stroke-width="2"/>
                                        <path d="m21 21-4.35-4.35" stroke-width="2"/>
                                    </svg>
                                    <span>Lancer la recherche</span>
                                </div>
                            </button>

                            <!-- Info bulle -->
                            <div class="mt-6 text-center">
                                <p class="text-purple-200 text-sm italic">
                                    💡 Astuce : Sélectionnez au moins une catégorie pour affiner vos résultats
                                </p>
                            </div>
                        </form>
                    </div>

                    <!-- Navigation rapide -->
                    <div class="mt-8 bg-white/5 backdrop-blur-lg rounded-2xl p-6 border border-white/10 fade-in"
                         style="animation-delay: 0.8s">
                        <h3 class="text-white font-semibold mb-3 flex items-center gap-2" 
                            style="font-family: Georgia, serif;">
                            <span class="text-2xl">ℹ️</span>
                            <span>Navigation rapide</span>
                        </h3>
                        <div class="grid grid-cols-2 md:grid-cols-5 gap-3 text-sm">
                            <button
                                v-for="filter in filters"
                                :key="filter.id"
                                @click="selectFilter(filter.id)"
                                class="px-3 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition-all text-xs"
                                :style="{ borderLeft: `3px solid ${filter.color}` }">
                                {{ filter.label }}
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Vue.js DOIT être chargé AVANT notre code -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    sidebarCollapsed: false,
                    adminMenuOpen: false,
                    searchTerm: 'Couleur B2B',
                    stars: [],
                    filters: [
                        { id: 'carto', label: 'Carto', icon: '🗺️', color: '#9B59B6', checked: false },
                        { id: 'tag', label: 'Tag', icon: '🏷️', color: '#2ECC71', checked: false },
                        { id: 'process', label: 'Process', icon: '⚙️', color: '#E74C3C', checked: true },
                        { id: 'flow', label: 'Flow', icon: '🌊', color: '#3498DB', checked: false },
                        { id: 'ressources', label: 'Ressources', icon: '💻', color: '#F39C12', checked: false }
                    ]
                }
            },
            methods: {
                alert(message) {
                    window.alert(message);
                },
                handleSearch() {
                    const checkedFilters = this.filters.filter(f => f.checked);
                    
                    if (checkedFilters.length === 0) {
                        alert('Veuillez sélectionner au moins un filtre !');
                        return;
                    }

                    const activeFilter = checkedFilters[0];
                    // Redirection vers la fiche correspondante
                    window.location.href = `uranie-fiche-${activeFilter.id}-vue.html?q=${encodeURIComponent(this.searchTerm)}`;
                },
                goToHome() {
                    window.location.href = 'uranie-accueil-vue.html';
                },
                selectFilter(filterId) {
                    // Décocher tous
                    this.filters.forEach(f => f.checked = false);
                    // Cocher celui sélectionné
                    const filter = this.filters.find(f => f.id === filterId);
                    if (filter) filter.checked = true;
                },
                getLabelStyle(filter) {
                    if (filter.checked) {
                        return {
                            borderColor: filter.color,
                            backgroundColor: filter.color + '40'
                        };
                    }
                    return {
                        borderColor: 'rgba(255,255,255,0.3)',
                        backgroundColor: 'rgba(255,255,255,0.05)'
                    };
                },
                generateStars() {
                    const sizes = ['w-1 h-1', 'w-0.5 h-0.5'];
                    for (let i = 0; i < 30; i++) {
                        this.stars.push({
                            id: i,
                            left: Math.random() * 100 + '%',
                            top: Math.random() * 100 + '%',
                            delay: Math.random() * 2 + 's',
                            size: sizes[Math.floor(Math.random() * sizes.length)]
                        });
                    }
                },
                loadUrlParams() {
                    // Lire les paramètres URL
                    const params = new URLSearchParams(window.location.search);
                    const query = params.get('q');
                    const category = params.get('category');
                    
                    if (query) {
                        this.searchTerm = query;
                    }
                    
                    if (category) {
                        // Mapper les catégories vers les IDs de filtres
                        const categoryMap = {
                            'carto': 'carto',
                            'kusmi tea': 'tag',
                            'process': 'process',
                            'flow': 'flow',
                            'hardware': 'ressources'
                        };
                        const filterId = categoryMap[category.toLowerCase()];
                        if (filterId) {
                            this.selectFilter(filterId);
                        }
                    }
                }
            },
            mounted() {
                this.generateStars();
                this.loadUrlParams();
            }
        }).mount('#app');
    </script>
</body>
</html>
